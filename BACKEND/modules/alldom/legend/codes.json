{
  "meta": {
    "version": "1.0",
    "description": "ALLDOM Legend codes aligned with CYMONIDES ontology and I/O Matrix standard",
    "updated_at": "2026-01-11",
    "philosophy": "INPUT = entity type you HAVE, OUTPUT = node_type + properties you GET. Operations (current/history/reverse) are parameters, NOT separate codes."
  },
  "entity_types": {
    "_comment": "Core INPUT types - what you can search BY (what you HAVE)",
    "email": {
      "code": 1,
      "node_type": "email",
      "description": "Email address",
      "aliases": ["email_address", "e-mail", "mail"]
    },
    "phone": {
      "code": 2,
      "node_type": "phone",
      "description": "Phone number",
      "aliases": ["phone_number", "telephone", "tel", "mobile"]
    },
    "username": {
      "code": 3,
      "node_type": "username",
      "description": "Username or handle",
      "aliases": ["handle", "screen_name", "user"]
    },
    "domain": {
      "code": 6,
      "node_type": "domain",
      "description": "Domain name",
      "aliases": ["domain_name", "website", "hostname"]
    },
    "url": {
      "code": 5,
      "node_type": "url",
      "description": "Full URL",
      "aliases": ["web_address", "link", "uri"]
    },
    "person_name": {
      "code": 7,
      "node_type": "person",
      "description": "Person's full name",
      "aliases": ["name", "full_name", "person"]
    },
    "ip_address": {
      "code": 8,
      "node_type": "ip_address",
      "description": "IPv4 or IPv6 address",
      "aliases": ["ip", "ip_addr", "ipv4", "ipv6"]
    },
    "address": {
      "code": 11,
      "node_type": "address",
      "description": "Physical/postal address",
      "aliases": ["postal_address", "street_address", "location"]
    },
    "company_name": {
      "code": 13,
      "node_type": "company",
      "description": "Company/organization name",
      "aliases": ["company", "org_name", "business_name", "legal_name"]
    },
    "company_reg_id": {
      "code": 14,
      "node_type": "company",
      "description": "Company registration number",
      "aliases": ["company_number", "crn", "registration_number", "ein"]
    }
  },
  "property_codes": {
    "_comment": "OUTPUT field codes - properties within schemas",
    "person": {
      "person_name": 7,
      "person_dob": 12,
      "person_nationality": 9,
      "person_country": 10,
      "person_address": 11,
      "person_email": 1,
      "person_phone": 2
    },
    "company": {
      "company_name": 13,
      "company_reg_id": 14,
      "company_vat_id": 15,
      "company_previous_name": 16,
      "company_email": 44,
      "company_phone": 45,
      "company_website": 46,
      "company_address": 47,
      "company_country": 48,
      "company_status": 49,
      "company_incorporation_date": 50,
      "company_dissolution_date": 51,
      "company_type": 52,
      "company_officers": 58,
      "company_beneficial_owners": 66,
      "company_shareholders": 71,
      "company_lei": 420,
      "company_parent": 422,
      "company_subsidiary": 424
    },
    "domain": {
      "domain_name": 6,
      "domain_registrar": 80,
      "domain_registrant": 81,
      "domain_registrant_email": 82,
      "domain_registrant_org": 83,
      "domain_creation_date": 84,
      "domain_expiry_date": 85,
      "domain_updated_date": 86,
      "domain_nameservers": 87,
      "domain_status": 88,
      "domain_privacy_protected": 89,
      "domain_dns_a": 90,
      "domain_dns_aaaa": 91,
      "domain_dns_mx": 92,
      "domain_dns_ns": 93,
      "domain_dns_txt": 94,
      "domain_dns_cname": 95
    },
    "ip_address": {
      "ip_address": 8,
      "ip_version": 100,
      "ip_hostname": 101,
      "ip_asn": 102,
      "ip_asn_org": 103,
      "ip_country": 104,
      "ip_city": 105,
      "ip_linked_domains": 106
    },
    "email": {
      "email_address": 1,
      "email_domain": 6,
      "email_local_part": 110,
      "email_linked_domains": 111,
      "email_linked_persons": 112
    },
    "phone": {
      "phone_number": 2,
      "phone_country_code": 120,
      "phone_carrier": 121,
      "phone_line_type": 122,
      "phone_location": 123,
      "phone_linked_persons": 124
    },
    "url": {
      "url_full": 5,
      "url_domain": 6,
      "url_path": 130,
      "url_anchor_text": 131,
      "url_first_seen": 132,
      "url_last_seen": 133
    }
  },
  "relationship_types": {
    "_comment": "Aligned with CYMONIDES edge_types.json - relationships between nodes",
    "ownership": [
      "officer_of",
      "beneficial_owner_of",
      "owner_of",
      "shareholder_of",
      "subsidiary_of",
      "owns",
      "owned_by",
      "registrant_of",
      "owns_domain"
    ],
    "contact_info": [
      "has_phone",
      "has_email",
      "has_address",
      "has_website"
    ],
    "employment": [
      "employs",
      "employed_by",
      "director_of"
    ],
    "location": [
      "headquartered_at",
      "registered_in",
      "resides_at",
      "located_at",
      "located_in"
    ],
    "link_intelligence": [
      "links_to",
      "subdomain_of",
      "shares_tracker",
      "hosted_at"
    ],
    "association": [
      "related_to",
      "linked_to",
      "partner_of",
      "affiliated_with"
    ],
    "evidence": [
      "mentioned_in",
      "extracted_from",
      "documented_by",
      "has_profile"
    ],
    "family": [
      "married_to",
      "child_of",
      "sibling_of"
    ],
    "compliance": [
      "flagged_with",
      "involved_in_litigation"
    ]
  },
  "output_schemas": {
    "_comment": "What you GET from operations - defined by node_type + properties, NOT by operation mode",
    "person": {
      "node_type": "person",
      "properties": ["person_name", "person_dob", "person_nationality", "person_country", "person_address"],
      "edges_to": ["company", "address", "email", "phone", "url"]
    },
    "company": {
      "node_type": "company",
      "properties": ["company_name", "company_reg_id", "company_status", "company_country", "company_address", "company_incorporation_date"],
      "edges_to": ["person", "company", "address", "domain", "email", "phone"]
    },
    "domain": {
      "node_type": "domain",
      "properties": ["domain_name", "domain_registrar", "domain_registrant", "domain_creation_date", "domain_expiry_date", "domain_nameservers"],
      "edges_to": ["person", "company", "email", "ip_address", "domain", "url"]
    },
    "ip_address": {
      "node_type": "ip_address",
      "properties": ["ip_address", "ip_version", "ip_hostname", "ip_asn", "ip_asn_org", "ip_country"],
      "edges_to": ["domain", "company"]
    },
    "email": {
      "node_type": "email",
      "properties": ["email_address", "email_domain"],
      "edges_to": ["person", "company", "domain"]
    },
    "phone": {
      "node_type": "phone",
      "properties": ["phone_number", "phone_country_code", "phone_carrier", "phone_line_type"],
      "edges_to": ["person", "company"]
    },
    "address": {
      "node_type": "address",
      "properties": ["address"],
      "edges_to": ["person", "company", "country", "region"]
    },
    "url": {
      "node_type": "url",
      "properties": ["url_full", "url_domain", "url_path"],
      "edges_to": ["domain", "url", "person", "company"]
    }
  },
  "resource_operations": {
    "_comment": "Operations are PARAMETERS to resources, not separate output codes",
    "whois": {
      "modes": ["current", "history", "reverse", "cluster"],
      "default_mode": "current",
      "accepts": [1, 6, 13],
      "returns": ["domain", "person", "company", "email", "address"]
    },
    "dns": {
      "modes": ["current", "history"],
      "default_mode": "current",
      "accepts": [6],
      "returns": ["domain", "ip_address"]
    },
    "backlinks": {
      "modes": ["domains", "pages"],
      "default_mode": "domains",
      "accepts": [6, 5],
      "returns": ["domain", "url"]
    },
    "ip_lookup": {
      "modes": ["current", "reverse_dns", "geolocation"],
      "default_mode": "current",
      "accepts": [8],
      "returns": ["ip_address", "domain"]
    },
    "archive": {
      "modes": ["snapshots", "content"],
      "default_mode": "snapshots",
      "accepts": [6, 5],
      "returns": ["url"]
    }
  }
}
