{
  "$schema": "./operator_registry_schema.json",
  "version": "1.0.0",
  "last_updated": "2026-01-01",
  "operators": [
    {
      "id": "chain_pipe",
      "syntax": "=>",
      "category": "chain",
      "name": "Chain Pipe",
      "description": "Pipes output from one operator to the next. Just regular operators chained.",
      "examples": [
        {"query": "p: John Smith => c?", "description": "Person search → extract companies"},
        {"query": "bl? :!example.com => p?", "description": "Backlinks → extract persons"},
        {"query": "c: Acme Corp => ent?", "description": "Company search → extract entities"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_chain_pipe",
      "input_type": ["query"],
      "output_type": ["varies"]
    },
    {
      "id": "chain_preset",
      "syntax": "chain:",
      "category": "chain",
      "name": "Chain Preset",
      "description": "Multi-step investigation presets",
      "examples": [
        {"query": "chain: due_diligence c: Acme Corp :US", "description": "Full Due Diligence"},
        {"query": "chain: ubo c: Siemens AG :DE", "description": "Ultimate Beneficial Owners"},
        {"query": "chain: officers c: Tesco PLC :UK", "description": "Officers + Sanctions"},
        {"query": "chain: pep p: John Smith", "description": "PEP check"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_chain",
      "input_type": ["entity"],
      "output_type": ["report"]
    },
    {
      "id": "p_prefix",
      "syntax": "p:",
      "category": "io_prefix",
      "name": "Person Investigation",
      "description": "Full person investigation across all configured sources",
      "examples": [
        {"query": "p: John Smith", "description": "Person investigation"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "execute_person",
      "input_type": ["person_name"],
      "output_type": ["entities", "relationships"]
    },
    {
      "id": "c_prefix",
      "syntax": "c:",
      "category": "io_prefix",
      "name": "Company Investigation",
      "description": "Full company investigation with optional jurisdiction",
      "examples": [
        {"query": "c: Acme Corp", "description": "Company investigation"},
        {"query": "c: Acme Corp :US", "description": "Company with jurisdiction"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "execute_company",
      "input_type": ["company_name"],
      "output_type": ["entities", "registry_records"]
    },
    {
      "id": "e_prefix",
      "syntax": "e:",
      "category": "io_prefix",
      "name": "Email Investigation",
      "description": "Email address OSINT investigation",
      "examples": [
        {"query": "e: john@example.com", "description": "Email investigation"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "execute_email",
      "input_type": ["email"],
      "output_type": ["breach_data", "contact_info"]
    },
    {
      "id": "d_prefix",
      "syntax": "d:",
      "syntax_variants": ["dom:"],
      "category": "io_prefix",
      "name": "Domain Investigation",
      "description": "Domain OSINT investigation",
      "examples": [
        {"query": "d: example.com", "description": "Domain investigation"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "execute_domain",
      "input_type": ["domain"],
      "output_type": ["whois_records", "entities"]
    },
    {
      "id": "t_prefix",
      "syntax": "t:",
      "category": "io_prefix",
      "name": "Phone Investigation",
      "description": "Phone number OSINT investigation",
      "examples": [
        {"query": "t: +1-555-0123", "description": "Phone investigation"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "execute_phone",
      "input_type": ["phone"],
      "output_type": ["contact_info"]
    },
    {
      "id": "cuk",
      "syntax": "cuk:",
      "category": "jurisdiction",
      "name": "UK Company",
      "description": "UK Companies House lookup",
      "jurisdiction": "UK",
      "examples": [
        {"query": "cuk: Tesco PLC", "description": "UK company registry"}
      ],
      "handler_module": "country_engines.UK.uk_unified",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "puk",
      "syntax": "puk:",
      "category": "jurisdiction",
      "name": "UK Person",
      "description": "UK person search",
      "jurisdiction": "UK",
      "examples": [
        {"query": "puk: John Smith", "description": "UK person search"}
      ],
      "handler_module": "country_engines.UK.uk_unified",
      "handler_function": "search_person",
      "input_type": ["person_name"],
      "output_type": ["entities"]
    },
    {
      "id": "reguk",
      "syntax": "reguk:",
      "category": "jurisdiction",
      "name": "UK Regulatory",
      "description": "UK regulatory/registry data",
      "jurisdiction": "UK",
      "examples": [
        {"query": "reguk: FCA", "description": "UK regulatory search"}
      ],
      "handler_module": "country_engines.UK.uk_unified",
      "handler_function": "search_regulatory",
      "input_type": ["query"],
      "output_type": ["registry_records"]
    },
    {
      "id": "lituk",
      "syntax": "lituk:",
      "category": "jurisdiction",
      "name": "UK Litigation",
      "description": "UK litigation search",
      "jurisdiction": "UK",
      "examples": [
        {"query": "lituk: Acme Corp", "description": "UK litigation search"}
      ],
      "handler_module": "country_engines.UK.uk_unified",
      "handler_function": "search_litigation",
      "input_type": ["entity"],
      "output_type": ["documents"]
    },
    {
      "id": "chr",
      "syntax": "chr:",
      "category": "jurisdiction",
      "name": "Croatian Company",
      "description": "Croatian company registry",
      "jurisdiction": "HR",
      "examples": [
        {"query": "chr: Podravka", "description": "Croatian company"}
      ],
      "handler_module": "TORPEDO.torpedo",
      "handler_function": "fetch_profile",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "chu",
      "syntax": "chu:",
      "category": "jurisdiction",
      "name": "Hungarian Company",
      "description": "Hungarian company registry",
      "jurisdiction": "HU",
      "examples": [
        {"query": "chu: OTP Bank", "description": "Hungarian company"}
      ],
      "handler_module": "TORPEDO.torpedo",
      "handler_function": "fetch_profile",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "cde",
      "syntax": "cde:",
      "category": "jurisdiction",
      "name": "German Company",
      "description": "German company registry",
      "jurisdiction": "DE",
      "examples": [
        {"query": "cde: Siemens AG", "description": "German company"}
      ],
      "handler_module": "TORPEDO.torpedo",
      "handler_function": "fetch_profile",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "pde",
      "syntax": "pde:",
      "category": "jurisdiction",
      "name": "German Person",
      "description": "German person search",
      "jurisdiction": "DE",
      "examples": [
        {"query": "pde: Hans Mueller", "description": "German person"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "execute_person",
      "input_type": ["person_name"],
      "output_type": ["entities"]
    },
    {
      "id": "cno",
      "syntax": "cno:",
      "category": "jurisdiction",
      "name": "Norwegian Company",
      "description": "Norwegian company registry (Brønnøysund)",
      "jurisdiction": "NO",
      "examples": [
        {"query": "cno: Equinor", "description": "Norwegian company"}
      ],
      "handler_module": "country_engines.NO.no_unified",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "cfi",
      "syntax": "cfi:",
      "category": "jurisdiction",
      "name": "Finnish Company",
      "description": "Finnish company registry",
      "jurisdiction": "FI",
      "examples": [
        {"query": "cfi: Nokia", "description": "Finnish company"}
      ],
      "handler_module": "country_engines.FI.fi_unified",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "cch",
      "syntax": "cch:",
      "category": "jurisdiction",
      "name": "Swiss Company",
      "description": "Swiss commercial registry",
      "jurisdiction": "CH",
      "examples": [
        {"query": "cch: Nestlé", "description": "Swiss company"}
      ],
      "handler_module": "country_engines.CH.ch_unified",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "cie",
      "syntax": "cie:",
      "category": "jurisdiction",
      "name": "Irish Company",
      "description": "Irish Companies Registration Office",
      "jurisdiction": "IE",
      "examples": [
        {"query": "cie: Ryanair", "description": "Irish company"}
      ],
      "handler_module": "country_engines.IE.ie_unified",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "ccz",
      "syntax": "ccz:",
      "category": "jurisdiction",
      "name": "Czech Company",
      "description": "Czech ARES registry",
      "jurisdiction": "CZ",
      "examples": [
        {"query": "ccz: Skoda", "description": "Czech company"}
      ],
      "handler_module": "country_engines.CZ.cz_cli",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "cbe",
      "syntax": "cbe:",
      "category": "jurisdiction",
      "name": "Belgian Company",
      "description": "Belgian KBO/BCE registry",
      "jurisdiction": "BE",
      "examples": [
        {"query": "cbe: AB InBev", "description": "Belgian company"}
      ],
      "handler_module": "country_engines.BE.be_cli",
      "handler_function": "search_company",
      "input_type": ["company_name"],
      "output_type": ["registry_records"]
    },
    {
      "id": "lei",
      "syntax": "lei:",
      "category": "jurisdiction",
      "name": "GLEIF LEI Lookup",
      "description": "Global Legal Entity Identifier lookup",
      "jurisdiction": "GLOBAL",
      "examples": [
        {"query": "lei: 5493001KJTIIGC8Y1R12", "description": "LEI lookup"}
      ],
      "handler_module": "country_engines.GLEIF.gleif_cli",
      "handler_function": "lookup_lei",
      "input_type": ["lei_code"],
      "output_type": ["registry_records"]
    },
    {
      "id": "bl_pages",
      "syntax": "bl?",
      "category": "link_analysis",
      "name": "Backlinks (Pages)",
      "description": "Find all pages that link to target",
      "examples": [
        {"query": "bl? :!domain.com", "description": "Backlink pages to domain"},
        {"query": "bl? :domain.com/page!", "description": "Backlink pages to specific URL"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_backlinks_pages",
      "input_type": ["domain", "url"],
      "output_type": ["pages"]
    },
    {
      "id": "bl_domains",
      "syntax": "?bl",
      "category": "link_analysis",
      "name": "Backlinks (Domains)",
      "description": "Find unique domains that link to target (fast)",
      "examples": [
        {"query": "?bl :!domain.com", "description": "Backlink domains (fast)"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_backlinks_domains",
      "input_type": ["domain", "url"],
      "output_type": ["domains"]
    },
    {
      "id": "bl_batch",
      "syntax": "bl? :!domain1 :!domain2",
      "syntax_variants": ["bl? :!domain1 AND :!domain2", "?bl :!domain1 :!domain2"],
      "category": "link_analysis",
      "name": "Backlinks (Batch Multi-Domain)",
      "description": "Find backlinks for multiple domains in parallel. Supports space-separated or AND-separated domain targets. Returns aggregated results with per-domain breakdown.",
      "examples": [
        {"query": "bl? :!portofino.com :!portofino.io :!portofinotech.com", "description": "Page backlinks for 3 domains"},
        {"query": "bl? :!domain1 AND :!domain2 AND :!domain3", "description": "AND-separated syntax"},
        {"query": "?bl :!domain1 :!domain2", "description": "Fast domain-level batch"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_multi_domain_backlinks",
      "input_type": ["domains"],
      "output_type": ["backlinks_aggregated", "summary"]
    },
    {
      "id": "ol_pages",
      "syntax": "ol?",
      "category": "link_analysis",
      "name": "Outlinks (Pages)",
      "description": "Find all pages linked from target",
      "examples": [
        {"query": "ol? :!domain.com", "description": "Outlink pages from domain"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_outlinks",
      "input_type": ["domain", "url"],
      "output_type": ["pages"]
    },
    {
      "id": "ol_domains",
      "syntax": "?ol",
      "category": "link_analysis",
      "name": "Outlinks (Domains)",
      "description": "Find unique domains linked from target (fast)",
      "examples": [
        {"query": "?ol :!domain.com", "description": "Outlink domains (fast)"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_outlinks",
      "input_type": ["domain", "url"],
      "output_type": ["domains"]
    },
    {
      "id": "rl_domains",
      "syntax": "?rl",
      "category": "link_analysis",
      "name": "Related/Co-cited Domains",
      "description": "Find co-cited domains (Majestic)",
      "examples": [
        {"query": "?rl :!domain.com", "description": "Co-cited domains"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_related_links",
      "input_type": ["domain"],
      "output_type": ["domains"]
    },
    {
      "id": "ipl_domains",
      "syntax": "?ipl",
      "category": "link_analysis",
      "name": "IP-Linked Domains",
      "description": "Find domains on same IP or /24 subnet",
      "examples": [
        {"query": "?ipl :!domain.com", "description": "IP-linked domains"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_hosted_domains",
      "input_type": ["domain"],
      "output_type": ["domains"]
    },
    {
      "id": "owl_domains",
      "syntax": "?owl",
      "category": "link_analysis",
      "name": "Ownership-Linked Domains",
      "description": "Find domains with same registrant (WHOIS)",
      "examples": [
        {"query": "?owl :!domain.com", "description": "Same-owner domains"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "reverse_whois",
      "input_type": ["domain"],
      "output_type": ["domains"]
    },
    {
      "id": "ent_extract",
      "syntax": "@entity?",
      "syntax_variants": ["@ent?"],
      "category": "entity_extraction",
      "name": "Extract All Entities",
      "description": "Extract all entity types from target using AI-powered LINKLATER extraction",
      "examples": [
        {"query": "@entity? :!company.com", "description": "All entities from domain"},
        {"query": "@ent? :2022! !domain.com", "description": "Entities from 2022 archives"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["entities"]
    },
    {
      "id": "p_extract",
      "syntax": "@person?",
      "syntax_variants": ["@p?"],
      "category": "entity_extraction",
      "name": "Extract Persons",
      "description": "Extract person names from target using AI-powered extraction",
      "examples": [
        {"query": "@person? :!company.com", "description": "Persons from domain"},
        {"query": "@p? :!#querynode", "description": "Persons (short form)"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["person_entities"]
    },
    {
      "id": "c_extract",
      "syntax": "@company?",
      "syntax_variants": ["@c?"],
      "category": "entity_extraction",
      "name": "Extract Companies",
      "description": "Extract company names from target using AI-powered extraction",
      "examples": [
        {"query": "@company? :!company.com", "description": "Companies from domain"},
        {"query": "@c? :domain.com/page!", "description": "Companies (short form)"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["company_entities"]
    },
    {
      "id": "e_extract",
      "syntax": "@email?",
      "syntax_variants": ["@e?"],
      "category": "entity_extraction",
      "name": "Extract Emails",
      "description": "Extract email addresses from target using regex + AI extraction",
      "examples": [
        {"query": "@email? :!company.com", "description": "Emails from domain"},
        {"query": "@e? :!#querynode", "description": "Emails (short form)"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["email_entities"]
    },
    {
      "id": "t_extract",
      "syntax": "@phone?",
      "syntax_variants": ["@t?"],
      "category": "entity_extraction",
      "name": "Extract Phones",
      "description": "Extract phone numbers from target using GLiNER + AI extraction",
      "examples": [
        {"query": "@phone? :!company.com", "description": "Phones from domain"},
        {"query": "@t? :!domain.com", "description": "Phones (short form)"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["phone_entities"]
    },
    {
      "id": "a_extract",
      "syntax": "@address?",
      "syntax_variants": ["@a?"],
      "category": "entity_extraction",
      "name": "Extract Addresses",
      "description": "Extract physical addresses from target using AI extraction",
      "examples": [
        {"query": "@address? :!company.com", "description": "Addresses from domain"},
        {"query": "@a? :#source!", "description": "Addresses (short form)"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["address_entities"]
    },
    {
      "id": "u_extract",
      "syntax": "@username?",
      "syntax_variants": ["@u?"],
      "category": "entity_extraction",
      "name": "Extract Usernames",
      "description": "Extract social media usernames and handles from target",
      "examples": [
        {"query": "@username? :!company.com", "description": "Usernames from domain"},
        {"query": "@u? :!domain.com", "description": "Usernames (short form)"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_entity_extraction",
      "input_type": ["domain", "url"],
      "output_type": ["username_entities"]
    },
    {
      "id": "pdf_filetype",
      "syntax": "pdf!",
      "category": "filetype",
      "name": "PDF Files",
      "description": "Find PDF files on domain",
      "file_extensions": ["pdf"],
      "examples": [
        {"query": "pdf! :!sebgroup.com", "description": "PDFs on domain"}
      ],
      "handler_module": "brute.targeted_searches.filetypes.filetype",
      "handler_function": "search_filetype",
      "input_type": ["domain"],
      "output_type": ["documents"]
    },
    {
      "id": "doc_filetype",
      "syntax": "doc!",
      "category": "filetype",
      "name": "All Documents",
      "description": "Find all document types (pdf, doc, xls, ppt)",
      "file_extensions": ["pdf", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "odt", "rtf", "txt"],
      "examples": [
        {"query": "doc! :!company.com", "description": "All documents on domain"}
      ],
      "handler_module": "brute.targeted_searches.filetypes.filetype",
      "handler_function": "search_filetype",
      "input_type": ["domain"],
      "output_type": ["documents"]
    },
    {
      "id": "word_filetype",
      "syntax": "word!",
      "category": "filetype",
      "name": "Word Documents",
      "description": "Find Word documents",
      "file_extensions": ["doc", "docx", "odt", "rtf"],
      "examples": [
        {"query": "word! :!company.com", "description": "Word docs on domain"}
      ],
      "handler_module": "brute.targeted_searches.filetypes.filetype",
      "handler_function": "search_filetype",
      "input_type": ["domain"],
      "output_type": ["documents"]
    },
    {
      "id": "xls_filetype",
      "syntax": "xls!",
      "category": "filetype",
      "name": "Excel Spreadsheets",
      "description": "Find Excel files",
      "file_extensions": ["xls", "xlsx", "ods", "csv"],
      "examples": [
        {"query": "xls! :!company.com", "description": "Excel files on domain"}
      ],
      "handler_module": "brute.targeted_searches.filetypes.filetype",
      "handler_function": "search_filetype",
      "input_type": ["domain"],
      "output_type": ["documents"]
    },
    {
      "id": "ppt_filetype",
      "syntax": "ppt!",
      "category": "filetype",
      "name": "PowerPoint",
      "description": "Find PowerPoint presentations",
      "file_extensions": ["ppt", "pptx", "odp"],
      "examples": [
        {"query": "ppt! :!company.com", "description": "PowerPoint on domain"}
      ],
      "handler_module": "brute.targeted_searches.filetypes.filetype",
      "handler_function": "search_filetype",
      "input_type": ["domain"],
      "output_type": ["documents"]
    },
    {
      "id": "file_filetype",
      "syntax": "file!",
      "category": "filetype",
      "name": "All Files",
      "description": "Find all file types",
      "file_extensions": ["pdf", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "odt", "rtf", "txt", "ods", "csv", "odp"],
      "examples": [
        {"query": "file! :!domain.com", "description": "All files on domain"}
      ],
      "handler_module": "brute.targeted_searches.filetypes.filetype",
      "handler_function": "search_filetype",
      "input_type": ["domain"],
      "output_type": ["documents"]
    },
    {
      "id": "year_single",
      "syntax": "YYYY!",
      "category": "historical",
      "name": "Single Year",
      "description": "Filter to single year archives",
      "examples": [
        {"query": "ent? :2024! !domain.com", "description": "Entities from 2024"},
        {"query": "2022! :?domain.com", "description": "Snapshots from 2022"}
      ],
      "handler_module": "LINKLATER.temporal_core",
      "handler_function": "search_archives",
      "input_type": ["year", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "year_range",
      "syntax": "YYYY-YYYY!",
      "category": "historical",
      "name": "Year Range",
      "description": "Filter to year range archives",
      "examples": [
        {"query": "ent? :2020-2024! !domain.com", "description": "Entities from 2020-2024"}
      ],
      "handler_module": "LINKLATER.temporal_core",
      "handler_function": "search_archives",
      "input_type": ["year_range", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "historical_back",
      "syntax": "<-YYYY!",
      "category": "historical",
      "name": "Back to Year",
      "description": "From now back to specified year",
      "examples": [
        {"query": "bl? :<-2015! !domain.com", "description": "Backlinks back to 2015"}
      ],
      "handler_module": "LINKLATER.temporal_core",
      "handler_function": "search_archives",
      "input_type": ["year", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "historical_all",
      "syntax": "<-!",
      "category": "historical",
      "name": "All Historical",
      "description": "All historical archives",
      "examples": [
        {"query": "ent? :<-! !domain.com", "description": "All historical entities"}
      ],
      "handler_module": "LINKLATER.temporal_core",
      "handler_function": "search_archives",
      "input_type": ["domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "date_specific",
      "syntax": "DD.MM.YYYY!",
      "category": "historical",
      "name": "Specific Date",
      "description": "Snapshots nearest to specific date (European format)",
      "examples": [
        {"query": "15.03.2019! :?domain.com", "description": "Snapshots near March 15, 2019"}
      ],
      "handler_module": "LINKLATER.temporal_core",
      "handler_function": "search_archives",
      "input_type": ["date", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "keyword_live",
      "syntax": "keyword :?domain",
      "category": "keyword_search",
      "name": "Live Domain Search",
      "description": "Search keyword on live domain",
      "examples": [
        {"query": "privacy :?example.com", "description": "Search 'privacy' on live domain"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "search_live",
      "input_type": ["keyword", "domain"],
      "output_type": ["pages"]
    },
    {
      "id": "keyword_archive_back",
      "syntax": "keyword :<-domain",
      "category": "keyword_search",
      "name": "Archive Search (Backwards)",
      "description": "Search archived versions backwards in time",
      "examples": [
        {"query": "GDPR :<-example.com", "description": "Search archives backwards"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "search_archives",
      "input_type": ["keyword", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "keyword_archive_forward",
      "syntax": "keyword :->domain",
      "category": "keyword_search",
      "name": "Archive Search (Forwards)",
      "description": "Search archived versions forwards in time",
      "examples": [
        {"query": "GDPR :->example.com", "description": "Search archives forwards"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "search_archives",
      "input_type": ["keyword", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "keyword_archive_bidi",
      "syntax": "keyword :-><-domain",
      "category": "keyword_search",
      "name": "Archive Search (Bidirectional)",
      "description": "Search archives in both directions",
      "examples": [
        {"query": "GDPR :-><-example.com", "description": "Bidirectional archive search"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "search_archives",
      "input_type": ["keyword", "domain"],
      "output_type": ["archive_snapshots"]
    },
    {
      "id": "domain_discover",
      "syntax": "?domain",
      "category": "navigation",
      "name": "Domain Discovery",
      "description": "Discover all URLs on domain via sitemaps, robots.txt, archives",
      "examples": [
        {"query": "?example.com", "description": "Discover all URLs on domain"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "discover",
      "input_type": ["domain"],
      "output_type": ["pages"]
    },
    {
      "id": "page_scrape",
      "syntax": "domain/path?",
      "category": "navigation",
      "name": "Page Scrape",
      "description": "Scrape specific page content",
      "examples": [
        {"query": "example.com/about?", "description": "Scrape specific page"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "page_scrape",
      "input_type": ["url"],
      "output_type": ["raw_content"]
    },
    {
      "id": "tor_context",
      "syntax": ":tor",
      "syntax_variants": [":onion"],
      "category": "context",
      "name": "Tor Context",
      "description": "Search via Tor engines",
      "examples": [
        {"query": "\"bitcoin\" :tor", "description": "Search Tor for bitcoin"},
        {"query": "ent? :!xyz.onion", "description": "Extract from onion site"}
      ],
      "handler_module": "LINKLATER.scraping.tor.tor_crawler",
      "handler_function": "search_tor",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "cdom_macro",
      "syntax": "cdom:",
      "category": "macro",
      "name": "Company Domain",
      "description": "Find company website/domain via registry lookup, brute search, and domain extraction",
      "examples": [
        {"query": "cdom: Acme Corp", "description": "Find Acme's website domain"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "find_company_domain",
      "chain": ["c:", "brute", "d?"],
      "input_type": ["company_name"],
      "output_type": ["domains"]
    },
    {
      "id": "age_macro",
      "syntax": "age:",
      "category": "macro",
      "name": "Person Age",
      "description": "Find person age/DOB via EYE-D breach data, registry filings, and web search",
      "examples": [
        {"query": "age: John Smith", "description": "Find John's age/DOB"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "find_person_age",
      "chain": ["p:", "e:", "brute \"DOB\" OR \"born\" OR \"age\""],
      "input_type": ["person_name"],
      "output_type": ["entities", "dates"]
    },
    {
      "id": "alldom_macro",
      "syntax": "alldom:",
      "category": "macro",
      "name": "Full Domain Analysis",
      "description": "Complete LINKLATER analysis: backlinks, outlinks, WHOIS ownership, related domains, IP co-hosting, GA tracking, tech stack, historical archives, entity extraction",
      "examples": [
        {"query": "alldom: example.com", "description": "Run ALL LINKLATER operations on domain"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "LinkLater.full_domain_analysis",
      "chain": ["bl?", "?bl", "ol?", "?ol", "?rl", "?ipl", "?owl", "whois:", "tech:", "ga?", "<-!", "ent?"],
      "input_type": ["domain"],
      "output_type": ["entities", "relationships", "domains", "links", "pages"]
    },
    {
      "id": "crel_macro",
      "syntax": "crel:",
      "category": "macro",
      "name": "Related Companies",
      "description": "Find related companies via ownership links, shared officers, domain co-hosting, GA clusters",
      "examples": [
        {"query": "crel: Acme Corp", "description": "Find companies related to Acme"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "LinkLater.find_related_companies",
      "chain": ["c:", "?owl", "?ipl", "ga?", "p? => c:"],
      "input_type": ["company_name"],
      "output_type": ["company_entities", "relationships"]
    },
    {
      "id": "rep_macro",
      "syntax": "rep:",
      "category": "macro",
      "name": "Reputation Analytics",
      "description": "Reputation analysis via reviews, complaints, news, social media, red flags",
      "examples": [
        {"query": "rep: example.com", "description": "Full reputation analysis"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "analyze_reputation",
      "chain": ["brute \"review\" OR \"complaint\" OR \"scam\" OR \"fraud\"", "news!", "red_flag:"],
      "input_type": ["domain", "company_name"],
      "output_type": ["entities", "sentiment", "red_flags"]
    },
    {
      "id": "matrix_forward",
      "syntax": "TYPE=>[?]",
      "category": "matrix",
      "name": "Matrix Forward Lookup",
      "description": "What outputs from this input type?",
      "examples": [
        {"query": "c=>[?]", "description": "What can I get from company?"},
        {"query": "chu=>[?]", "description": "What from Hungarian company?"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "parse_matrix_query",
      "input_type": ["type_spec"],
      "output_type": ["routes"]
    },
    {
      "id": "matrix_reverse",
      "syntax": "[?]=>TYPE",
      "category": "matrix",
      "name": "Matrix Reverse Lookup",
      "description": "What inputs produce this output?",
      "examples": [
        {"query": "[?]=>e", "description": "What produces email?"},
        {"query": "[?]=>officers", "description": "What gives officer data?"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "parse_matrix_query",
      "input_type": ["type_spec"],
      "output_type": ["routes"]
    },
    {
      "id": "matrix_route",
      "syntax": "TYPE=>TYPE",
      "category": "matrix",
      "name": "Matrix Route Lookup",
      "description": "How to get from A to B?",
      "examples": [
        {"query": "c=>officers", "description": "Company to officers route"},
        {"query": "p=>e", "description": "Person to email route"}
      ],
      "handler_module": "input_output.matrix.io_cli",
      "handler_function": "parse_matrix_query",
      "input_type": ["type_spec"],
      "output_type": ["routes"]
    },
    {
      "id": "whois_enrichment",
      "syntax": "whois:",
      "category": "enrichment",
      "name": "WHOIS Lookup",
      "description": "Domain registration data",
      "examples": [
        {"query": "whois:example.com", "description": "WHOIS lookup"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "whois_lookup",
      "input_type": ["domain"],
      "output_type": ["whois_records"]
    },
    {
      "id": "dns_enrichment",
      "syntax": "dns:",
      "category": "enrichment",
      "name": "DNS Records",
      "description": "DNS records (A, AAAA, MX, NS, TXT, CNAME, SOA)",
      "examples": [
        {"query": "dns: example.com", "description": "Full DNS lookup"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_macro",
      "input_type": ["domain"],
      "output_type": ["dns_records"]
    },
    {
      "id": "subdomains_enrichment",
      "syntax": "subdomains:",
      "category": "enrichment",
      "name": "Subdomain Discovery",
      "description": "Find subdomains",
      "examples": [
        {"query": "subdomains:example.com", "description": "Find subdomains"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "discover_subdomains",
      "input_type": ["domain"],
      "output_type": ["domains"]
    },
    {
      "id": "tech_enrichment",
      "syntax": "tech:",
      "category": "enrichment",
      "name": "Technology Stack",
      "description": "Detect technology stack",
      "examples": [
        {"query": "tech:example.com", "description": "Tech stack detection"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "get_tech_stack",
      "input_type": ["domain"],
      "output_type": ["metadata"]
    },
    {
      "id": "similar_discovery",
      "syntax": "similar?",
      "category": "enrichment",
      "name": "Similar Pages",
      "description": "Find similar pages (Exa API)",
      "examples": [
        {"query": "similar? :!domain.com", "description": "Find similar pages"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "find_similar",
      "input_type": ["domain", "url"],
      "output_type": ["pages"]
    },
    {
      "id": "ga_discovery",
      "syntax": "ga?",
      "category": "enrichment",
      "name": "Google Analytics Detection",
      "description": "Detect GA/GTM codes, find related domains",
      "examples": [
        {"query": "ga? :!domain.com", "description": "GA detection"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "ga_tracker",
      "input_type": ["domain"],
      "output_type": ["tracking_codes", "domains"]
    },
    {
      "id": "tag_add",
      "syntax": "=> +#tag",
      "category": "tagging",
      "name": "Add Tag",
      "description": "Add tag to results",
      "examples": [
        {"query": "?bl :!domain.com => +#backlink_sources", "description": "Tag backlinks"}
      ],
      "handler_module": "SASTRE.bulk.tagging",
      "handler_function": "apply_tag",
      "input_type": ["results"],
      "output_type": ["tagged_results"]
    },
    {
      "id": "tag_remove",
      "syntax": "=> -#tag",
      "category": "tagging",
      "name": "Remove Tag",
      "description": "Remove tag from results",
      "examples": [
        {"query": "=> -#old_tag", "description": "Remove old tag"}
      ],
      "handler_module": "SASTRE.bulk.tagging",
      "handler_function": "remove_tag",
      "input_type": ["results"],
      "output_type": ["tagged_results"]
    },
    {
      "id": "tag_result",
      "syntax": "=> #tag",
      "category": "tagging",
      "name": "Tag Results",
      "description": "Tag/label results",
      "examples": [
        {"query": "ent? :!domain.com => #EXTRACTED", "description": "Tag extracted entities"}
      ],
      "handler_module": "SASTRE.bulk.tagging",
      "handler_function": "apply_tag",
      "input_type": ["results"],
      "output_type": ["tagged_results"]
    },
    {
      "id": "tag_workstream",
      "syntax": "=> #workstream_ws",
      "category": "tagging",
      "name": "Link to Workstream",
      "description": "Link results to narrative workstream",
      "examples": [
        {"query": "=> #investigation_ws", "description": "Link to workstream"}
      ],
      "handler_module": "SASTRE.bulk.tagging",
      "handler_function": "link_workstream",
      "input_type": ["results"],
      "output_type": ["linked_results"]
    },
    {
      "id": "bulk_and",
      "syntax": "(#node1 AND #node2)",
      "category": "bulk_selection",
      "name": "Boolean AND Selection",
      "description": "Select intersection of nodes",
      "examples": [
        {"query": "(#john AND #acme) => brute!{de!}", "description": "Both nodes, German TLD"}
      ],
      "handler_module": "SASTRE.bulk.selection",
      "handler_function": "parse_bulk_selection",
      "input_type": ["nodes"],
      "output_type": ["selection"]
    },
    {
      "id": "bulk_or",
      "syntax": "(#a OR #b)",
      "category": "bulk_selection",
      "name": "Boolean OR Selection",
      "description": "Select union of nodes",
      "examples": [
        {"query": "(#suspects OR #pois) => ent?", "description": "Either node set"}
      ],
      "handler_module": "SASTRE.bulk.selection",
      "handler_function": "parse_bulk_selection",
      "input_type": ["nodes"],
      "output_type": ["selection"]
    },
    {
      "id": "class_filter",
      "syntax": "@CLASS",
      "category": "filter",
      "name": "Class Filter",
      "description": "Filter by entity class",
      "values": ["@PERSON", "@COMPANY", "@ASSET", "@SOURCE", "@QUERY", "@LOCATION", "@DOCUMENT", "@NARRATIVE", "@SUBJECT"],
      "examples": [
        {"query": "@COMPANY ##jurisdiction:CY => #OFFSHORE", "description": "Cyprus companies"}
      ],
      "handler_module": "modules.syntax.parser",
      "handler_function": "parse_class_filter",
      "input_type": ["query"],
      "output_type": ["filtered_results"]
    },
    {
      "id": "dimension_filter",
      "syntax": "##dimension:value",
      "category": "filter",
      "name": "Dimension Filter",
      "description": "Filter by dimension (jurisdiction, year, etc.)",
      "examples": [
        {"query": "##jurisdiction:CY", "description": "Cyprus jurisdiction"},
        {"query": "##2020", "description": "Year 2020"},
        {"query": "##unchecked", "description": "Unchecked items"}
      ],
      "handler_module": "modules.syntax.parser",
      "handler_function": "parse_dimension_filter",
      "input_type": ["query"],
      "output_type": ["filtered_results"]
    },
    {
      "id": "macro_red_flag",
      "syntax": "red_flag:",
      "syntax_variants": ["rf:"],
      "category": "macro",
      "name": "Red Flag Focus",
      "description": "Reputation/adverse focus (complaints, fraud signals, negative reporting). Alias of rep: with red-flag emphasis.",
      "examples": [
        {"query": "red_flag: example.com", "description": "Adverse/reputation focus for a domain"},
        {"query": "rf: Acme Corp", "description": "Adverse/reputation focus for a company"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_macro",
      "input_type": ["domain", "company_name", "query"],
      "output_type": ["entities", "sentiment", "red_flags"]
    },
    {
      "id": "compare",
      "syntax": "=?",
      "category": "comparison",
      "name": "Compare/Similarity",
      "description": "Compare nodes or find similar entities",
      "examples": [
        {"query": "=? :#john_smith :#john_j_smith", "description": "Are these the same?"},
        {"query": "=? :#target :@COMPANY", "description": "Similar companies"}
      ],
      "handler_module": "modules.syntax.operators",
      "handler_function": "compare_entities",
      "input_type": ["entities"],
      "output_type": ["similarity_scores"]
    },
    {
      "id": "handshake",
      "syntax": "handshake",
      "syntax_variants": ["beer", "\ud83e\udd1d", "\ud83c\udf7a"],
      "category": "pairwise",
      "name": "Handshake/N×N Compare",
      "description": "Everyone meets everyone - pairwise comparison",
      "examples": [
        {"query": "(#john AND #jane AND #acme) => \ud83e\udd1d", "description": "N×N comparison"}
      ],
      "handler_module": "SASTRE.bulk.handshake",
      "handler_function": "execute_handshake",
      "input_type": ["nodes"],
      "output_type": ["similarity_matrix"]
    },
    {
      "id": "target_domain",
      "syntax": "!domain",
      "category": "target_scope",
      "name": "Domain Scope (Expanded)",
      "description": "Target entire domain",
      "examples": [
        {"query": "bl? :!domain.com", "description": "Backlinks to domain"}
      ],
      "handler_module": "modules.syntax.parser",
      "handler_function": "parse_target",
      "input_type": ["domain"],
      "output_type": ["scope"]
    },
    {
      "id": "target_page",
      "syntax": "domain/path!",
      "category": "target_scope",
      "name": "Page Scope (Contracted)",
      "description": "Target specific page only",
      "examples": [
        {"query": "?bl :domain.com/path!", "description": "Backlinks to specific page"}
      ],
      "handler_module": "modules.syntax.parser",
      "handler_function": "parse_target",
      "input_type": ["url"],
      "output_type": ["scope"]
    },
    {
      "id": "grid_node_expanded",
      "syntax": "!#nodename",
      "category": "grid",
      "name": "Grid Node (Expanded)",
      "description": "Node + all related edges",
      "examples": [
        {"query": "ent? :!#query1", "description": "Entities from node + related"}
      ],
      "handler_module": "modules.syntax.parser",
      "handler_function": "parse_grid_target",
      "input_type": ["node_id"],
      "output_type": ["nodes_with_edges"]
    },
    {
      "id": "grid_node_contracted",
      "syntax": "#nodename!",
      "category": "grid",
      "name": "Grid Node (Contracted)",
      "description": "That node only, no expansion",
      "examples": [
        {"query": "ent? :#query1!", "description": "Entities from node only"}
      ],
      "handler_module": "modules.syntax.parser",
      "handler_function": "parse_grid_target",
      "input_type": ["node_id"],
      "output_type": ["single_node"]
    },
    {
      "id": "def_cde",
      "syntax": "[cde]",
      "category": "definitional",
      "name": "German Company Patterns",
      "description": "German company designators (GmbH, AG, etc.)",
      "patterns": ["GmbH", "AG", "SE", "UG", "KG", "OHG", "mbH"],
      "examples": [
        {"query": "[cde] automotive", "description": "German automotive companies"}
      ],
      "handler_module": "server.directory_search.definitional_shorthands",
      "handler_function": "expand_shorthand",
      "input_type": ["query"],
      "output_type": ["expanded_query"]
    },
    {
      "id": "def_cuk",
      "syntax": "[cuk]",
      "category": "definitional",
      "name": "UK Company Patterns",
      "description": "UK company designators (Ltd, PLC, etc.)",
      "patterns": ["Ltd", "PLC", "Limited", "LLP"],
      "examples": [
        {"query": "[cuk] finance", "description": "UK finance companies"}
      ],
      "handler_module": "server.directory_search.definitional_shorthands",
      "handler_function": "expand_shorthand",
      "input_type": ["query"],
      "output_type": ["expanded_query"]
    },
    {
      "id": "def_cus",
      "syntax": "[cus]",
      "category": "definitional",
      "name": "US Company Patterns",
      "description": "US company designators (Inc, Corp, LLC, etc.)",
      "patterns": ["Inc", "Corp", "LLC", "Corporation", "Co."],
      "examples": [
        {"query": "[cus] tech", "description": "US tech companies"}
      ],
      "handler_module": "server.directory_search.definitional_shorthands",
      "handler_function": "expand_shorthand",
      "input_type": ["query"],
      "output_type": ["expanded_query"]
    },
    {
      "id": "def_pde",
      "syntax": "[pde]",
      "category": "definitional",
      "name": "German Person Patterns",
      "description": "German person patterns (Herr, Frau, Dr., etc.)",
      "patterns": ["Herr", "Frau", "Dr.", "Prof.", "Geschäftsführer"],
      "examples": [
        {"query": "[pde] \"board member\"", "description": "German board members"}
      ],
      "handler_module": "server.directory_search.definitional_shorthands",
      "handler_function": "expand_shorthand",
      "input_type": ["query"],
      "output_type": ["expanded_query"]
    },
    {
      "id": "engine_google",
      "syntax": "GO:",
      "syntax_variants": ["google:"],
      "category": "single_engine",
      "name": "Google Only",
      "description": "Search only Google",
      "examples": [
        {"query": "GO: site:example.com filetype:pdf", "description": "Google with native syntax"}
      ],
      "handler_module": "brute",
      "handler_function": "search_single_engine",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "engine_bing",
      "syntax": "BI:",
      "syntax_variants": ["bing:"],
      "category": "single_engine",
      "name": "Bing Only",
      "description": "Search only Bing",
      "examples": [
        {"query": "BI: query", "description": "Bing search"}
      ],
      "handler_module": "brute",
      "handler_function": "search_single_engine",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "engine_brave",
      "syntax": "BR:",
      "syntax_variants": ["brave:"],
      "category": "single_engine",
      "name": "Brave Only",
      "description": "Search only Brave",
      "examples": [
        {"query": "BR: query", "description": "Brave search"}
      ],
      "handler_module": "brute",
      "handler_function": "search_single_engine",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "engine_ddg",
      "syntax": "DD:",
      "syntax_variants": ["duckduckgo:"],
      "category": "single_engine",
      "name": "DuckDuckGo Only",
      "description": "Search only DuckDuckGo",
      "examples": [
        {"query": "DD: query", "description": "DuckDuckGo search"}
      ],
      "handler_module": "brute",
      "handler_function": "search_single_engine",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "engine_yandex",
      "syntax": "YA:",
      "syntax_variants": ["yandex:"],
      "category": "single_engine",
      "name": "Yandex Only",
      "description": "Search only Yandex",
      "examples": [
        {"query": "YA: query", "description": "Yandex search"}
      ],
      "handler_module": "brute",
      "handler_function": "search_single_engine",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "engine_cymonides",
      "syntax": "CY:",
      "syntax_variants": ["cy:", "cymonides:"],
      "category": "single_engine",
      "name": "Cymonides Only",
      "description": "Direct Cymonides search across graph/text/link indices",
      "examples": [
        {"query": "CY: breach records john.smith@example.com", "description": "Cymonides breach/entity search"},
        {"query": "CY: domain:example.com", "description": "Cymonides domain-focused search"}
      ],
      "handler_module": "CYMONIDES.cymonides_unified",
      "handler_function": "execute_unified_search",
      "input_type": ["query"],
      "output_type": ["search_results", "entities"]
    },
    {
      "id": "tld_de",
      "syntax": "de!",
      "category": "tld_filter",
      "name": "German TLD Filter",
      "description": "Restrict to .de domains",
      "site_filters": ["site:.de"],
      "examples": [
        {"query": "brute{\"GmbH\" AND de!}", "description": "German TLD only"}
      ],
      "handler_module": "modules.syntax.operators",
      "handler_function": "get_tld_site_filters",
      "input_type": ["query"],
      "output_type": ["filtered_query"]
    },
    {
      "id": "tld_uk",
      "syntax": "uk!",
      "category": "tld_filter",
      "name": "UK TLD Filter",
      "description": "Restrict to .uk domains",
      "site_filters": ["site:.uk", "site:.co.uk"],
      "examples": [
        {"query": "brute{\"Ltd\" AND uk!}", "description": "UK TLD only"}
      ],
      "handler_module": "modules.syntax.operators",
      "handler_function": "get_tld_site_filters",
      "input_type": ["query"],
      "output_type": ["filtered_query"]
    },
    {
      "id": "tld_gov",
      "syntax": "gov!",
      "category": "tld_filter",
      "name": "Government TLD Filter",
      "description": "Restrict to .gov domains",
      "site_filters": ["site:.gov", "site:.gov.*"],
      "examples": [
        {"query": "brute{gov!}", "description": "Government TLD only"}
      ],
      "handler_module": "modules.syntax.operators",
      "handler_function": "get_tld_site_filters",
      "input_type": ["query"],
      "output_type": ["filtered_query"]
    },
    {
      "id": "tld_news",
      "syntax": "news!",
      "category": "tld_filter",
      "name": "News Sources Filter",
      "description": "Restrict to news engines",
      "engine_tiers": ["NewsAPI", "GDELT", "Google News", "Bing News"],
      "examples": [
        {"query": "brute{news!}", "description": "News sources only"}
      ],
      "handler_module": "modules.syntax.operators",
      "handler_function": "get_tld_engine_tiers",
      "input_type": ["query"],
      "output_type": ["filtered_query"]
    },
    {
      "id": "brute_search",
      "syntax": "brute",
      "syntax_variants": ["brute!"],
      "category": "brute_search",
      "name": "Brute Search",
      "description": "Search across 40+ engines for maximum recall",
      "examples": [
        {"query": "\"John Smith\"", "description": "Exact phrase 40+ engines"},
        {"query": "(#john AND #acme) => brute{de!}", "description": "Bulk brute with TLD"}
      ],
      "handler_module": "Search_Types.brute",
      "handler_function": "search",
      "input_type": ["query"],
      "output_type": ["pages"]
    },
    {
      "id": "cmd_enrich",
      "syntax": "/enrich",
      "category": "command",
      "name": "Enrich Entity",
      "description": "Imperative: Fill entity slots with additional data",
      "examples": [
        {"query": "p? => /enrich => sanctions?", "description": "Extract persons then enrich"},
        {"query": "/enrich :#officers", "description": "Enrich tagged officers"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_enrich",
      "input_type": ["@PERSON", "@COMPANY", "@ASSET"],
      "output_type": ["enriched_entity"]
    },
    {
      "id": "cmd_scrape",
      "syntax": "/scrape",
      "category": "command",
      "name": "Scrape Content",
      "description": "Imperative: Fetch and scrape URL content",
      "examples": [
        {"query": "ol? => /scrape => ent?", "description": "Get outlinks then scrape them"},
        {"query": "/scrape :#sources", "description": "Scrape tagged sources"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_scrape",
      "input_type": ["@SOURCE", "@DOMAIN"],
      "output_type": ["scraped_content"]
    },
    {
      "id": "cmd_brute",
      "syntax": "/brute",
      "category": "command",
      "name": "Brute Search Command",
      "description": "Imperative: Search entity across 40+ engines",
      "examples": [
        {"query": "#john_smith => /brute", "description": "Brute search a tagged entity"},
        {"query": "/brute{de!} :#target", "description": "Brute with TLD filter"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_brute",
      "input_type": ["@PERSON", "@COMPANY", "@SUBJECT", "*"],
      "output_type": ["pages"]
    },
    {
      "id": "cmd_clink",
      "syntax": "/clink",
      "syntax_variants": ["🤝", "🍺"],
      "category": "command",
      "name": "Clink (N×N Compare)",
      "description": "Imperative: Compare all selected entities pairwise, find connections",
      "examples": [
        {"query": "(#john AND #jane AND #acme) => /clink", "description": "Pairwise comparison"},
        {"query": "#officers => /clink", "description": "Compare all officers"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_clink",
      "input_type": ["@PERSON", "@COMPANY", "@SUBJECT", "*"],
      "output_type": ["connections", "edges"]
    },
    {
      "id": "conditional",
      "syntax": "IF",
      "category": "control_flow",
      "name": "Conditional Branching",
      "description": "Execute operators conditionally based on state",
      "examples": [
        {"query": "IF #adverse THEN phase:escalation ELSE phase:writing", "description": "Branch on tag"},
        {"query": "IF filled? :#ubo THEN skip ELSE c: [SHAREHOLDER]", "description": "Check slot fill"},
        {"query": "IF NOT filled? :#section_ubo THEN foreach #shareholders => c:", "description": "Negated condition"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_conditional",
      "input_type": ["condition"],
      "output_type": ["varies"]
    },
    {
      "id": "cmd_translate",
      "syntax": "/tr",
      "category": "command",
      "name": "Translate",
      "description": "Imperative: Translate to language - attach code directly: /trde, /trfr, /trru",
      "examples": [
        {"query": "/trde :#query", "description": "Translate to German"},
        {"query": "/trru :#search_term", "description": "Translate to Russian"},
        {"query": "p: John Smith => /trhu", "description": "Person search then translate to Hungarian"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "_execute_translate",
      "input_type": ["*"],
      "output_type": ["translated_text"]
    },
    {
      "id": "agent_wikiman",
      "syntax": "wikiman:",
      "category": "agent_direct",
      "name": "WikiMan Jurisdictional Query",
      "description": "Direct query to WikiMan for jurisdiction-specific public records, research limitations, and investigative insights",
      "examples": [
        {"query": "wikiman: GR asset trace limitations", "description": "Greek asset trace limitations"},
        {"query": "wikiman: UK company registries", "description": "UK corporate registry sources"},
        {"query": "wikiman: DE litigation sources", "description": "German litigation research sources"}
      ],
      "handler_module": "SASTRE.agents.wikiman_bridge",
      "handler_function": "execute_wikiman_query",
      "input_type": ["jurisdiction_query"],
      "output_type": ["jurisdictional_insights"]
    },
    {
      "id": "agent_edith",
      "syntax": "edith:",
      "category": "agent_direct",
      "name": "EDITH Template Search",
      "description": "Direct semantic search of EDITH's template library - 200+ jurisdiction files, 30+ genres, 60+ cookbooks mined from 1,245 investigation reports",
      "examples": [
        {"query": "edith: Greek real estate limitations", "description": "Search for Greek real estate research context"},
        {"query": "edith: PEP screening Middle East", "description": "PEP screening templates for Middle East"},
        {"query": "edith: sanctions Russia oligarch", "description": "Sanctions investigation templates"}
      ],
      "handler_module": "SASTRE.agents.edith_bridge",
      "handler_function": "execute_edith_search",
      "input_type": ["template_query"],
      "output_type": ["template_results", "jurisdictional_context"]
    },
    {
      "id": "agent_cymonides",
      "syntax": "cymonides:",
      "syntax_variants": ["cy:"],
      "category": "agent_direct",
      "name": "Cymonides Full Index Search",
      "description": "Direct search across ALL 65 Cymonides Elasticsearch indices (2.3B documents) - not just WDC entities. Includes C-1 project graphs, C-2 text corpus, C-3 CommonCrawl link graph",
      "examples": [
        {"query": "cymonides: Greek shipping company Piraeus", "description": "Full-text search all indices"},
        {"query": "cy: breach records john.smith@example.com", "description": "Search breach records"},
        {"query": "cymonides: domain:example.com", "description": "Domain-specific search"}
      ],
      "handler_module": "CYMONIDES.cymonides_unified",
      "handler_function": "execute_unified_search",
      "input_type": ["search_query"],
      "output_type": ["search_results", "entities"]
    },
    {
      "id": "agent_nexus",
      "syntax": "nexus:",
      "syntax_variants": ["grid:"],
      "category": "agent_direct",
      "name": "NEXUS Project Grid Query",
      "description": "Direct query to NEXUS for project grid - search cymonides-1-{project_id}. Pass through existing grid syntax (#node, !#node, @type, /gridN, etc.)",
      "examples": [
        {"query": "nexus: #company_node", "description": "Query specific grid node"},
        {"query": "grid: @person", "description": "List all persons in project grid"},
        {"query": "nexus: !#adverse_media", "description": "Expand adverse media node"},
        {"query": "nexus: /gridN", "description": "Narrative view of project grid"}
      ],
      "handler_module": "modules.syntax.executor",
      "handler_function": "execute",
      "input_type": ["grid_syntax"],
      "output_type": ["grid_results", "nodes"]
    },
    {
      "id": "agent_linklater",
      "syntax": "linklater:",
      "syntax_variants": ["ll:"],
      "category": "agent_direct",
      "name": "LINKLATER Link Analysis",
      "description": "Direct call to LINKLATER's full capabilities - backlinks, WHOIS, tech stack, subdomain discovery, website analysis",
      "examples": [
        {"query": "linklater: backlinks example.com", "description": "Full backlink analysis"},
        {"query": "ll: whois example.com", "description": "WHOIS lookup"},
        {"query": "linklater: techstack example.com", "description": "Technology stack analysis"}
      ],
      "handler_module": "LINKLATER.api",
      "handler_function": "execute_linklater_query",
      "input_type": ["domain", "url"],
      "output_type": ["link_analysis", "whois_data", "tech_stack"]
    },
    {
      "id": "agent_corporella",
      "syntax": "corporella:",
      "syntax_variants": ["corp:"],
      "category": "agent_direct",
      "name": "CORPORELLA Company Intelligence",
      "description": "Direct call to CORPORELLA for company enrichment, OCCRP Aleph, SEC EDGAR, gap-aware routing",
      "examples": [
        {"query": "corporella: Acme Corp :US enrich", "description": "Enrich US company data"},
        {"query": "corp: search Shell PLC", "description": "Company search"},
        {"query": "corporella: aleph Siemens sanctions", "description": "OCCRP Aleph search"}
      ],
      "handler_module": "corporella.api",
      "handler_function": "execute_corporella_query",
      "input_type": ["company_name", "query"],
      "output_type": ["company_data", "sanctions_results"]
    },
    {
      "id": "agent_pacman",
      "syntax": "pacman:",
      "category": "agent_direct",
      "name": "PACMAN Entity Extraction",
      "description": "Direct call to PACMAN for entity extraction - regex patterns, GLiNER, AI extraction",
      "examples": [
        {"query": "pacman: extract https://example.com", "description": "Extract all entities from URL"},
        {"query": "pacman: classify https://example.com", "description": "Classify tier of URL"},
        {"query": "pacman: tripwire \"text with red flags\"", "description": "Red flag detection"}
      ],
      "handler_module": "PACMAN.pacman_cli",
      "handler_function": "execute_pacman_query",
      "input_type": ["url", "text"],
      "output_type": ["entities", "tier_classification"]
    },
    {
      "id": "agent_torpedo",
      "syntax": "torpedo:",
      "category": "agent_direct",
      "name": "TORPEDO Registry Direct",
      "description": "Direct call to TORPEDO for company registry searches across 50+ jurisdictions",
      "examples": [
        {"query": "torpedo: UK Tesco PLC", "description": "UK Companies House search"},
        {"query": "torpedo: DE Siemens AG", "description": "German Handelsregister search"},
        {"query": "torpedo: CH Nestlé SA", "description": "Swiss commercial register search"}
      ],
      "handler_module": "TORPEDO.torpedo",
      "handler_function": "execute_torpedo_query",
      "input_type": ["company_name", "jurisdiction"],
      "output_type": ["registry_records"]
    },
    {
      "id": "agent_brute",
      "syntax": "brute:",
      "category": "agent_direct",
      "name": "BRUTE Multi-Engine Search",
      "description": "Direct call to BRUTE for federated search across 40+ search engines with deduplication",
      "examples": [
        {"query": "brute: \"John Smith\" CEO London", "description": "Multi-engine exact phrase search"},
        {"query": "brute: site:example.com filetype:pdf", "description": "Site-specific PDF search"},
        {"query": "brute: inurl:about \"company name\"", "description": "About page search"}
      ],
      "handler_module": "brute.brute",
      "handler_function": "execute_brute_search",
      "input_type": ["search_query"],
      "output_type": ["search_results", "pages"]
    },
    {
      "id": "agent_serdavos",
      "syntax": "serdavos:",
      "syntax_variants": ["tor:", "onion:"],
      "category": "agent_direct",
      "name": "SERDAVOS Tor/Onion Search",
      "description": "Direct call to SERDAVOS for Tor/onion index searches",
      "examples": [
        {"query": "serdavos: search marketplace", "description": "Search Tor index"},
        {"query": "tor: onion site example", "description": "Search onion sites"},
        {"query": "onion: forum darknet", "description": "Search darknet forums"}
      ],
      "handler_module": "SERDAVOS.serdavos_mcp",
      "handler_function": "execute_serdavos_search",
      "input_type": ["search_query"],
      "output_type": ["tor_results"]
    },
    {
      "id": "agent_backdrill",
      "syntax": "backdrill:",
      "syntax_variants": ["archive:"],
      "category": "agent_direct",
      "name": "BACKDRILL Archive Search",
      "description": "Direct call to BACKDRILL for historical archive searches - Wayback Machine, CommonCrawl archives",
      "examples": [
        {"query": "backdrill: 2022 example.com", "description": "Wayback Machine 2022 snapshots"},
        {"query": "archive: commoncrawl example.com", "description": "CommonCrawl historical data"},
        {"query": "backdrill: timeline example.com", "description": "Full timeline of domain"}
      ],
      "handler_module": "BACKDRILL.backdrill",
      "handler_function": "execute_archive_search",
      "input_type": ["domain", "year"],
      "output_type": ["archive_results", "snapshots"]
    }
  ],
  "categories": {
    "agent_direct": "Direct agent addressing - route queries to specific subsystems (wikiman:, edith:, cymonides:, linklater:, corporella:, pacman:, torpedo:, brute:, serdavos:, backdrill:)",
    "chain": "Chain operators for piping and multi-step investigations",
    "io_prefix": "Entity investigation prefixes (p:, c:, e:, etc.)",
    "jurisdiction": "Jurisdiction-qualified operators (cuk:, chr:, etc.)",
    "link_analysis": "Link analysis operators (bl?, ol?, etc.)",
    "entity_extraction": "Entity extraction operators (@entity?, @person?, @company?, @p?, @c?, etc.)",
    "filetype": "Filetype discovery operators (pdf!, doc!, etc.)",
    "historical": "Historical/archive modifiers (YYYY!, <-!, etc.)",
    "keyword_search": "Keyword search operators (:?domain, :<-domain)",
    "navigation": "Navigation operators (?domain, domain?)",
    "context": "Context modifiers (:tor, :onion)",
    "macro": "Macro operators (cdom?, alldom?, etc.)",
    "matrix": "Matrix exploration operators (TYPE=>[?])",
    "enrichment": "Enrichment operators (whois:, dns:, etc.)",
    "tagging": "Tagging operators (=> +#tag, => -#tag)",
    "bulk_selection": "Bulk selection operators ((#a AND #b))",
    "filter": "Filter operators (@CLASS, ##dimension)",
    "comparison": "Comparison operators (=?)",
    "pairwise": "Pairwise comparison (handshake, beer)",
    "target_scope": "Target scoping (!domain, domain!)",
    "grid": "Grid node operators (!#node, #node!)",
    "definitional": "Definitional shorthands ([cde], [cuk])",
    "single_engine": "Single engine operators (GO:, BI:)",
    "tld_filter": "TLD filter operators (de!, uk!, gov!)",
    "brute_search": "Maximum recall search",
    "command": "Imperative command operators (/enrich, /scrape, /brute, /clink)",
    "control_flow": "Conditional branching (IF THEN ELSE)"
  }
}
